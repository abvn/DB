--课后作业   PPT6

-- 查询部门平均工资在2500元以上的部门名称及平均工资
-- SELECT d.DEPARTMENT_NAME,ROUND(AVG(e.SALARY),2) FROM DEPARTMENTS d,EMPLOYEES e WHERE d.DEPARTMENT_ID = e.DEPARTMENT_ID GROUP BY d.DEPARTMENT_NAME HAVING AVG(e.SALARY) > 2500
-- 查询员工岗位中不是以“SA”开头并且平均工资在2500元以上的岗位及平均工资，并按照工资降序排序
-- SELECT E.JOB_ID "岗位", ROUND(AVG(E.SALARY),2) "平均工资" FROM EMPLOYEES E GROUP BY E.JOB_ID HAVING E.JOB_ID NOT LIKE 'SA%' AND AVG(E.SALARY) > 2500 ORDER BY "平均工资" DESC
-- 查询部门人数在2人以上的部门名称、最低工资、最高工资，并对求得的工资进行四舍五入到整数位
-- SELECT d.DEPARTMENT_NAME,MIN(e.SALARY),MAX(e.SALARY) FROM DEPARTMENTS d,EMPLOYEES e WHERE d.DEPARTMENT_ID = e.DEPARTMENT_ID  GROUP BY d.DEPARTMENT_ID,d.DEPARTMENT_NAME HAVING COUNT(e.EMPLOYEE_ID) > 2
-- 查询岗位不为SA_REP，工资和大于等于2500的岗位及每种岗位的工资和
-- SELECT e.JOB_ID,SUM(e.SALARY) FROM EMPLOYEES e GROUP BY e.JOB_ID HAVING e.JOB_ID NOT LIKE 'SA_REP' AND SUM(e.SALARY) >= 2500
-- 显示经理号码和经理姓名，这个经理所管理员工的最低工资，没有经理的KING也要显示，不包括最低工资小于3000的，按最低工资由高到低排序
-- SELECT E.EMPLOYEE_ID,E.LAST_NAME,MIN(M.SALARY) "最低工资" FROM EMPLOYEES M LEFT JOIN EMPLOYEES E ON M.MANAGER_ID = E.EMPLOYEE_ID GROUP BY E.EMPLOYEE_ID,E.LAST_NAME HAVING (MIN(M.SALARY)>=3000) ORDER BY "最低工资" DESC
-- 写一个查询，显示每个部门最高工资和最低工资的差额。
-- SELECT MAX(e.SALARY) - MIN(e.SALARY) "工资差额",d.DEPARTMENT_ID "部门编号" FROM  DEPARTMENTS d,EMPLOYEES e WHERE d.DEPARTMENT_ID = e.DEPARTMENT_ID GROUP BY d.DEPARTMENT_ID